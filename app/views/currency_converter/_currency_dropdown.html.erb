<div class="custom-dropdown relative w-full">
  <!-- Selected option -->
  <div class="selected flex items-center justify-between border border-gray-300 rounded-lg px-3 py-2 bg-white shadow-sm cursor-pointer hover:border-blue-500 transition">
    <span class="text-gray-600">Select currency</span>
    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-500 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
    </svg>
  </div>

  <!-- Dropdown options -->
  <div class="options hidden absolute top-full left-0 w-full border border-gray-200 bg-white rounded-lg shadow-md mt-1 max-h-60 overflow-y-auto z-50">
    
    <!-- Search box -->
    <div class="p-2 sticky top-0 bg-white border-b border-gray-200">
      <input type="text"
             placeholder="Search currency..."
             class="w-full px-2 py-1 border rounded-md text-sm focus:ring-2 focus:ring-blue-500"
             onkeyup="filterOptions(this)">
    </div>

    <% currency_list.each do |c| %>
      <div class="option px-3 py-2 flex items-center gap-2 cursor-pointer hover:bg-gray-100 transition"
           data-value="<%= c[:code] %>"
           data-flag="<%= asset_path("flags/#{c[:flag]}.svg") %>"
           data-name="<%= c[:name] %>">
        <img src="<%= asset_path("flags/#{c[:flag]}.svg") %>" alt="<%= c[:name] %>" class="w-5 h-4">
        <span class="text-gray-700"><%= c[:code] %> - <%= c[:name] %></span>
      </div>
    <% end %>
  </div>

  <!-- Hidden input -->
  <input type="hidden" name="<%= name %>" id="<%= name %>">
</div>

<script>
  function filterOptions(input) {
    const filter = input.value.toLowerCase();
    const options = input.closest(".options").querySelectorAll(".option");

    options.forEach(option => {
      const text = option.textContent.toLowerCase();
      option.style.display = text.includes(filter) ? "" : "none";
    });
  }
</script>
